library(mlesky)
?mlskygrid
fit[[1]]
library(ape)
library(mlesky)
rm(list=ls())
set.seed(3)
alphaFun=function(x){sin(x)*10+12}
sampleDates=seq(2000,2020,0.1)
t=simCoal(sampleDates,alphaFun,alphaMin = 0.1)
pdf('simu.pdf',7,7)
plotBoth(t,alphaFun)
dev.off()
fit=as.list(rep(NA,3))
for (m in c(1,2,3)) {
fit[[m]]=mlskygrid(t,res=20,tau=NULL,tau_lower = 0.001,tau_upper = 10000,model = m,ncpu=6)
}
fit[[1]]$time
fit[[1]]$ne
distance=function(alphaFun,fit) {
sum((fit$ne-alphaFun(fit$time))^2)
}
distance(alphaFun,fit[[1]])
distance=function(alphaFun,fit) {
mean((fit$ne-alphaFun(fit$time))^2)
}
distance(alphaFun,fit[[1]])
for (m in c(2,3,1)) {
distance(alphaFun,fit[[m]])
}
for (m in c(2,3,1)) {
print(distance(alphaFun,fit[[m]]))
}
fit$time
fit[[1]]$time
distance=function(alphaFun,fit) {
mean((fit$ne-alphaFun(fit$time+max(sampleDates)))^2)
}
for (m in c(2,3,1)) {
print(distance(alphaFun,fit[[m]]))
}
fit[[1]]$time+max(sampleDates)
distance=function(alphaFun,fit) {
mean((fit$ne-alphaFun(fit$time+max(sampleDates)))^2)
}
distances=c()
for (m in c(2,3,1)) {
distances=c(distances,distance(alphaFun,fit[[m]]))
}
print(distances)
source('~/Projects/phylodynamics/mlesky-experiments/simulations/simuSinus2.R', echo=TRUE)
print(distances[c(2,3,1)])
source('~/Projects/phylodynamics/mlesky-experiments/simulations/simuSinus2.R', echo=TRUE)
length(seq(2000,2020,0.1))
source('~/Projects/phylodynamics/mlesky-experiments/simulations/simuSinus2.R', echo=TRUE)
distance(alphaFun,fit[[1]])
distance(alphaFun,fit[[2]])
distance(alphaFun,fit[[3]])
distances=c()
distances=cbind(distances,c(0,0,0))
distances=cbind(distances,c(0,0,0))
distances=cbind(distances,c(0,0,0))
distances=cbind(distances,c(0,0,0))
distances
source('~/Projects/phylodynamics/mlesky-experiments/simulations/simuSinus2.R', echo=TRUE)
source('~/Projects/phylodynamics/mlesky-experiments/simulations/simuSinus2.R', echo=TRUE)
samplesDates[1]
sampleDates[1]
sampleDates[2]
sampleDates[3]
distances
print(c(median(distances[,2]),median(distances[,3]),median(distances[,1])))
sort(distances[,3])
v=c(1,2,3,7,8,9,10)
print(c(median(distances[v,2]),median(distances[v,3]),median(distances[v,1])))
cbind(sort(distances[,1]),sort(distances[,2]),sort(distances[,3]))
cbind(sort(distances[,2]),sort(distances[,3]),sort(distances[,1]))
source('~/Projects/phylodynamics/mlesky-experiments/simulations/simuSinus2.R', echo=TRUE)
distances
source('~/Projects/phylodynamics/mlesky-experiments/simulations/simuBottleneck.R', echo=TRUE)
distance=function(alphaFun,fit) {
mean((fit$ne-alphaFun(fit$time+max(sampleDates)))^2)
}
print(distance(alphaFun,fit))
source('~/Projects/phylodynamics/mlesky-experiments/simulations/simuBottleneck.R', echo=TRUE)
source('~/Projects/phylodynamics/mlesky-experiments/simulations/simuBottleneck.R', echo=TRUE)
source('~/Projects/phylodynamics/mlesky-experiments/simulations/simuBottleneck.R', echo=TRUE)
source('~/Projects/phylodynamics/mlesky-experiments/simulations/simuBottleneck.R', echo=TRUE)
